from bs4 import BeautifulSoup

origin_name_file = '../materials/evilcorp.html'
new_name_file = '../materials/evilcorp_hacked.html'
new_title = 'Evil Corp - Stealing your money every day'

with open(origin_name_file, 'r') as fp:
    soup = BeautifulSoup(fp, 'lxml')
soup.title.string = new_title

pronoun = soup.find('span', class_='pronoun').string
name = soup.find('span', class_='name').contents[1]
new_tag = soup.new_tag('h1')
new_tag.string = f'{pronoun} {name}, you are hacked!'
soup.body.insert(1, new_tag)

new_script = '''
        hacked = function() {
            alert('hacked');
        }
        window.addEventListener('load', 
          function() { 
            var f = document.querySelector("form");
            f.setAttribute("onsubmit", "hacked()");
          },
          false
        );
'''
new_tag2 = soup.new_tag('script')
new_tag2.string = new_script
soup.body.append(new_tag2)

new_name_company = 'Fsociety'
new_link = 'https://mrrobot.fandom.com/wiki/Fsociety'

soup.find('a')['href'] = new_link
soup.find('a').string = new_name_company

with open(new_name_file, 'w') as fp:
    fp.write(soup.prettify())